select `orderkey`, `suppkey`, `quantity`, round(sum(`quantity`) over (partition by `suppkey` order by `orderkey` rows between unbounded_preceding and `preceding`(1)), 5) as `total_quantity`, `extendedprice`, round(sum(`extendedprice`) over (partition by `suppkey` order by `orderkey` rows between current_row and `following`(1)), 5) as `total_extendedprice`, `discount`, round(avg(`discount`) over (partition by `suppkey` order by `orderkey` rows between `following`(3) and unbounded_following), 5) as `avg_discount`
from `tpch`.`tiny`.`lineitem`
where `partkey` = 272